## Preamble

    EIP: 649
    Title: Metropolis Difficulty Bomb Delay and Issuance Reduction
    Authors: Afri Schoedon (Champion), Vitalik Buterin (Specification)
    Type: Standard Track
    Category: Core
    Status: Draft
    Created: 2017-06-21
    Replaces: 186

## Simple Summary
The average block times are increasing due to the difficulty bomb (also as known as the "ice age") slowly accelerating. This EIP proposes to delay the difficulty bomb for approximately one and a half year and to reduce the block rewards with the Metropolis fork.

## Abstract
After `METROPOLIS_FORK_BLKNUM` the client will calculate the difficulty based on a fake block number suggesting the client that the difficulty bomb is adjusting around 3 million blocks later than previously specified with the Homestead fork. Furthermore, to add an issuance reduction, block rewards will be adjusted to a base of 3 ETH, and uncle rewards will be adjusted accordingly.

## Motivation
The Casper development and switch to Proof-of-Stake is delayed, the Proof-of-Work should be feasible for miners and create new blocks every 15 seconds on average for another 1.4 years. The incentive to continue mining the Proof-of-Work chain after a potential move to Proof-of-Stake is reduced by adjusting block rewards.

## Specification
#### Relax Difficulty with Fake Block Number
For the purposes of `calc_difficulty`, simply replace the use of `block.number`, as used in the exponential ice age component, with the formula:

    fake_block_number = block.number - 3_000_000 if block.number >= METROPOLIS_FORK_BLKNUM else block.number

#### Adjust Block, Uncle, and Nephew rewards
To add an issuance reduction, adjust the block reward to `new_block_reward`, where

    new_block_reward = 3_000_000_000_000_000_000 if block.number >= METROPOLIS_FORK_BLKNUM else block.reward

(3E18 wei, or 3,000,000,000,000,000,000 wei, or 3 ETH).

Analogue, if an uncle is included in a block for `block.number >= METROPOLIS_FORK_BLKNUM` such that `block.number - uncle.number = k`, the uncle reward is

    new_uncle_reward = (8 - k) * new_block_reward / 8

This is the existing pre-Metropolis formula for uncle rewards, simply adjusted with `new_block_reward`.

The nephew reward for `block.number >= METROPOLIS_FORK_BLKNUM` is

    new_nephew_reward = new_block_reward / 32

This is the existing pre-Metropolis formula for nephew rewards, simply adjusted with `new_block_reward`.

## Rationale
This will delay the ice age by 42 million seconds ~= 1.4 years, so the chain would be back at 30 second block times at the end of 2018. An alternate proposal was to add special rules to the difficulty calculation to effectively _pause_ the difficulty between different blocks. That would lead to similar results.

This was previously discussed at All Core Devs Meeting [#09](https://github.com/ethereum/pm/blob/master/All%20Core%20Devs%20Meetings/Meeting%209.md#metropolis-timing-and-roadmap-discussion), [#12](https://github.com/ethereum/pm/blob/master/All%20Core%20Devs%20Meetings/Meeting%2012.md#5-metropolis-update), [#13](https://github.com/ethereum/pm/blob/master/All%20Core%20Devs%20Meetings/Meeting%2013.md#3-eip-186-reduce-eth-issuance-before-proof-of-stake-hudson), and [#14](https://github.com/ethereum/pm/blob/master/All%20Core%20Devs%20Meetings/Meeting%2014.md#1-eip-186-reduce-eth-issuance-before-proof-of-stake-core-devs). Consensus on the specification was achieved in All Core Devs Meeting [#19](https://github.com/ethereum/pm/blob/master/All%20Core%20Devs%20Meetings/Meeting%2019.md) and specification drafted in EIP issue [#649](https://github.com/ethereum/EIPs/issues/649).

It was decided to replace EIP [#186](https://github.com/ethereum/EIPs/issues/186) and include the issuance reduction along with the difficulty bomb delay in All Core Devs Meeting [#20](#) and [#21](#).

## Backwards Compatibility
This EIP is not forward compatible and introduces backwards incompatibilities in the difficulty calculation, as well as the block, uncle and nephew reward structure. Therefore, it should be included in a scheduled hardfork at a certain block number. It's suggested to include this EIP in the Metropolis fork.

## Test Cases
No test cases exist yet. But will be easy to set up based on the rules specified above.

## Implementation
None existing client implementation exists yet.

## Copyright
Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).
